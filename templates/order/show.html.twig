{% extends 'base.html.twig' %}

{% block title %}Détails de la commande #{{ order.reference }}{% endblock %}

{% block body %}
    <div style="max-width: 800px; margin: 0 auto;">
        <div style="margin-bottom: 2rem;">
            <a href="{{ path('app_profile') }}" style="color: var(--color-text-muted); text-decoration: none;">&larr; Retour au profil</a>
        </div>

        <div class="card">
            <div class="card-body">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;">
                    <div>
                        <h1 class="h3" style="margin-bottom: 0.5rem;">Commande #{{ order.reference }}</h1>
                        <p style="color: var(--color-text-muted);">
                            Passée le {{ order.createdAt|date('d/m/Y') }} à {{ order.createdAt|date('H:i') }}
                        </p>
                    </div>
                    <div>
                        <span style="display: inline-block; padding: 0.25rem 0.75rem; background-color: var(--color-foreground); color: var(--color-background); border-radius: 99px; font-weight: 500; font-size: 0.875rem;">
                            {{ order.status|capitalize }}
                        </span>
                    </div>
                </div>

                <div style="margin-bottom: 2rem;">
                    <h2 class="h5" style="margin-bottom: 1rem;">Articles</h2>
                    <div style="border-radius: var(--radius); border: 1px solid var(--color-border); overflow: hidden;">
                        <table class="table" style="margin-bottom: 0;">
                            <thead>
                                <tr style="background-color: var(--color-background-alt);">
                                    <th style="padding: 1rem;">Produit</th>
                                    <th style="padding: 1rem; text-align: center;">Prix</th>
                                    <th style="padding: 1rem; text-align: center;">Qté</th>
                                    <th style="padding: 1rem; text-align: right;">Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for item in order.orderItems %}
                                    <tr>
                                        <td style="padding: 1rem;">
                                            <div style="display: flex; align-items: center; gap: 1rem;">
                                                {% if item.product.imageName %}
                                                    <img src="{{ asset('images/products/' ~ item.product.imageName) }}" alt="{{ item.product.name }}" style="width: 48px; height: 48px; object-fit: cover; border-radius: 4px;">
                                                {% else %}
                                                    <img src="https://placehold.co/48x48?text=Img" alt="{{ item.product.name }}" style="border-radius: 4px;">
                                                {% endif %}
                                                <span style="font-weight: 500;">{{ item.product.name }}</span>
                                            </div>
                                        </td>
                                        <td style="padding: 1rem; text-align: center;">{{ item.price }} €</td>
                                        <td style="padding: 1rem; text-align: center;">{{ item.quantity }}</td>
                                        <td style="padding: 1rem; text-align: right; font-weight: 500;">{{ item.price * item.quantity }} €</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                            <tfoot>
                                <tr style="background-color: var(--color-background-alt);">
                                    <td colspan="3" style="padding: 1rem; text-align: right; font-weight: 600;">Total Commande</td>
                                    <td style="padding: 1rem; text-align: right; font-weight: 700; font-size: 1.1rem;">{{ order.total }} €</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>

                <div>
                    <h2 class="h5" style="margin-bottom: 1rem;">Livraison à</h2>
                    <div style="background-color: var(--color-background-alt); padding: 1.5rem; border-radius: var(--radius);">
                        <p style="font-weight: 500; margin-bottom: 0.25rem;">{{ app.user.fullName }}</p>
                        <p style="color: var(--color-text-muted); margin-bottom: 0;">
                            {{ app.user.address }}<br>
                            {{ app.user.postalCode }} {{ app.user.city }}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
